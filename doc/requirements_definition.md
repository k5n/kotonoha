# Kotonoha ver1.0 要件定義

## 1. アプリの目的とターゲットユーザー

### 目的

AIによる **Sentence Mining** を通じて、**音声とスクリプトで構成される言語コンテンツ**を効率的な学習教材へと転換させること。学習者が興味を持った文章中の未知の単語や表現を、AIが文脈に応じて即座に分析・解説することで、語彙の発見から理解、定着までの一連のプロセスを強力に支援する。これにより、学習者はより能動的かつ効率的に言語能力を向上させることができる。

### ターゲットユーザー

本アプリは、基礎的な文法と語彙を習得した**中級者**をメインターゲットとして設計されている。教科書レベルの知識から一歩進み、よりリアルなコンテンツを通じて実践的な語彙・表現力を伸ばしたい段階で最も効果を発揮する。

また、専門分野のドキュメントを読んだり、より高度な言い回しに触れたりする**上級者**にとっても、知識の抜け漏れを効率的に補うためのツールとして役立つ。

特定の学習法に縛られず、多様なスタイルで学ぶ全ての言語学習者を対象とする。

*   **音声コンテンツを中心に学習する人**:
    *   **音声ファイルと、それに対応するスクリプト（字幕ファイル）をお持ちの方**。ニュース、ポッドキャスト、オーディオブック、教材付属のCDなど、様々な素材を活用可能。
    *   教科書や市販の教材に付属する音声とスクリプトを使って、より深く学習したい人。
    *   TOEIC、TOEFLなどの資格試験対策として、特定の題材の語彙を集中して学びたい人。

*   **文脈を通じた深い理解を求める学習者**:
    *   単語帳での丸暗記ではなく、単語やイディオムが実際に使われる文脈（コンテキスト）の中で、そのニュアンスや使い方を深く理解したい人。
    *   AIによる解説を手がかりに、自らの知識を広げていく探求心のある人。

*   **初期ターゲットと将来の展望**:
    *   **初期ターゲット**: まずは、英語を学習する中級レベルの日本人ユーザーが直面する課題解決に注力する。
    *   **将来的な展望**: AIが対応可能なあらゆる言語の組み合わせ（学習言語と母国語）をサポートし、世界中の言語学習者のためのツールとなることを目指す。

---

## 2. 主要機能とユーザーフロー

### 2.1. 音声コンテンツの取り込みと管理

* **音声ファイルとスクリプトの取り込み**:
    * ユーザーがPC上の音声ファイルとスクリプトを選択し、アプリに取り込める機能。
    * スクリプトは各セリフの音声ファイルでのタイムスタンプを含むものとする。
* **エピソード管理**:
    * 取り込んだ音声ファイルとスクリプトのペアをエピソードとして一覧表示。
    * 各エピソードには、タイトル、再生時間、処理状況（Sentence Mining 数など）を表示。
    * エピソードの追加、編集、削除機能。

### 2.2. スクリプト管理

* **スクリプトの編集と修正**:
    * テキストをセリフ単位で編集できるUI。
    * 元の音声と、セリフを同期させて再生できる機能。
    * 取り込み時の修正版の違いを確認可能。

### 2.3. Sentence Mining の自動化とカード作成

* **Sentence Mining 対象の選択**:
    * セリフを順に表示。
    * ユーザーが不明な単語や表現を含むセリフに対して、**マウスクリック**で Sentence Mining 対象としてマークできる機能。
* **LLM を活用した意味抽出と説明生成**:
    * マークされたセンテンスとその前後のセリフをLLMに送信。
    * LLMが該当センテンスに含まれる単語やイディオムを抽出し、その意味と説明を生成。
    * 提示された単語やイディオムからユーザーが Sentence Mining したいものを選択できるUI。
    * 生成された意味と説明をユーザーに提示し、確認/修正できるUI。
* **Anki カード形式想定の保存**:
    * 抽出された単語/イディオムごとに、表裏の形式でデータを保存。
        * **表**: 該当センテンス（不明な単語/イディオムが強調表示）。
        * **裏**: 不明な単語/イディオムの意味と説明。
        * 一つのセンテンスに複数の不明箇所がある場合、それぞれが個別のカードとして保存される。
    * Anki へのエクスポート機能（CSV形式など）
* **エピソード内のSentence Mining 一覧表示**:
    * エピソードを選択すると、そのエピソードでSentence Mining されたカードが一覧表示される機能。
    * カードは初期状態で意味が隠れており、クリック/タップでアコーディオンのように開閉。
    * ユーザーの判断で、単語/イディオムを「保留（非表示）」扱いにできる機能（カードは残るが、リストから一時的に消える）。
* **センテンス単位の音声再生機能**:
    * 表示されているセンテンスに対応する音声部分を再生できる機能。

### 2.4. 単語/イディオムの蓄積と管理

* **単語/イディオムのデータベース管理**:
    * シンプルにするため、Sentence Mining された単語やイディオムは、別テーブルを設けずに Sentence Mining カードだけで管理。
    * 単語やイディオムは、動詞や複数形などの変化は原形としてSentence Mining カードに格納。（LLM への指示に含めるが、その通りになるかは LLM 依存）
* **習得度合いの管理（指標の表示）**:
    * 習得度合い自体の直接的な管理や間隔反復のアルゴリズムは、このアプリでは行わない。

### 2.5. エピソードのグループ化と表示順序管理

* **エピソードグループ機能**:
    * ユーザーはエピソードを任意のグループに分類できる。
    * グループの作成、名称変更、削除が可能。
    * 各エピソードは1つのグループに所属する。
* **グループおよびエピソードの表示順序管理**:
    * ユーザーはグループの表示順序を自由に変更できる（ドラッグ＆ドロップ等）。
    * 各グループ内で、エピソードの表示順序もユーザーが変更できる。
    * 並び順は永続化され、次回以降も維持される。

---

## 3. 非機能要件

* **クロスプラットフォーム対応**: Tauri 2.x を利用し、Windows, macOS, Linux で動作すること。
* **パフォーマンス**: 大量の動画/音声ファイルやSentence Mining データを取り扱っても、動作が遅くならないこと。AI 文字起こしやLLM連携の処理速度も考慮する。
* **UI/UX**: 直感的で使いやすいインターフェース。学習者がスムーズに作業を進められるデザイン。
* **拡張性**: 将来的に機能追加やAIモデルの変更に対応しやすいアーキテクチャ。
* **LLM連携**: LLMプロバイダーとの連携機能。APIキーの設定など、ユーザーが設定できること。（ver1 は Google Gemini に絞って良い）
* **プライバシー**: APIキーなどのセキュリティ情報が適切に管理され、外部に漏洩しない設計。

---

## 4. 将来的な拡張の可能性（現時点では対象外だが考慮に入れておく点）

* **スピーキング能力向上支援（MaskOutとの連携/統合）**:
    * 「英語穴埋め問題作成アプリ(MaskOut)」との連携強化、あるいは将来的な機能統合。
* **シャドーイング/ディクテーション/リピーティングの補助機能**:
    * センテンス単位の再生機能に加え、ループ再生、速度調整など、より高度な音声再生オプション。
* **多言語対応の強化**:
    * ターゲット言語や母国語の選択肢を拡充。
* **音声のみのコンテンツ対応**:
    * 音声ファイルのみでスクリプトがない場合、AIによる自動文字起こし機能を追加。   
* **音声のないスクリプトのサポート**:
    * 音声再生はTTSで行う。
* **複数環境でのデータ同期**:
    * クラウドストレージを利用したデータ同期機能。
