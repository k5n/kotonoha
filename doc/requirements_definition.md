# Immersion Learning 自動支援アプリ ver1.0 要件定義

## 1. アプリの目的とターゲットユーザー

### 目的

Immersion Language Learning における **Sentence Mining の省力化**と、**「習得」を目的とした復習（Passive Listening）の支援**。Anki に依存しない、より実践的な言語習得フローを確立することを目指す。

### ターゲットユーザー

* Immersion Language Learning を実践している人。
* 特に Intensive Immersion と Passive Listening を学習の主軸としている人。
* 初期段階では、英語を学習している日本人ユーザーを想定。将来的には、AI が対応する任意の言語学習者に対応可能にすることを目指す。
* 現在は自分自身のために作成するので上記。コンセプトとしては Immersion をやっていない人も使えるものにできるはず。

---

## 2. 主要機能とユーザーフロー

### 2.1. 音声コンテンツの取り込みと管理

* **音声ファイルとスクリプトの取り込み**:
    * ユーザーがPC上の音声ファイルとスクリプトを選択し、アプリに取り込める機能。
    * スクリプトは各セリフの音声ファイルでのタイムスタンプを含むものとする。
* **エピソード管理**:
    * 取り込んだ音声ファイルとスクリプトのペアをエピソードとして一覧表示。
    * 各エピソードには、タイトル、再生時間、処理状況（Sentence Mining 数など）を表示。
    * エピソードの追加、編集、削除機能。

### 2.2. スクリプト管理

* **スクリプトの編集と修正**:
    * **要件**:
        * テキストをセリフ単位で編集できるUI。
        * 元の音声と、セリフを同期させて再生できる機能。
        * 取り込み時 vs 修正版の差分表示。

### 2.3. Sentence Mining の自動化とカード作成

* **Sentence Mining 対象の選択**:
    * セリフを順に表示。
    * ユーザーが不明な単語や表現を含むセリフに対して、**マウスクリックやキーボードショートカット**で Sentence Mining 対象としてマークできる機能。
* **LLM を活用した意味抽出と説明生成**:
    * マークされたセンテンスとその前後のセリフをLLMに送信。
    * LLMが該当センテンスに含まれる単語やイディオムを抽出し、その意味と説明を生成。
    * 提示された単語やイディオムからユーザーが Sentence Mining したいものを選択できるUI。
    * 生成された意味と説明をユーザーに提示し、確認/修正できるUI。
* **Anki カード形式想定の保存**:
    * 抽出された単語/イディオムごとに、表裏の形式でデータを保存。
        * **表**: 該当センテンス（不明な単語/イディオムが強調表示）。
        * **裏**: 不明な単語/イディオムの意味と説明。
        * 一つのセンテンスに複数の不明箇所がある場合、それぞれが個別のカードとして保存される。
    * Anki へのエクスポート機能（CSV形式など）は ver1 では実装しない。
* **エピソード内のSentence Mining 一覧表示**:
    * エピソードを選択すると、そのエピソードでSentence Mining されたカードが一覧表示される機能。
    * カードは初期状態で意味が隠れており、クリック/タップでアコーディオンのように開閉。
    * 「全て開く」ボタンで、全てのアコーディオンを一括で開く機能。
    * Passive Listening 前に、この一覧をざっと確認できるUI。
    * ユーザーの判断で、単語/イディオムを「保留（非表示）」扱いにできる機能（カードは残るが、リストから一時的に消える）。
* **センテンス単位の音声再生機能**:
    * 表示されているセンテンスに対応する音声部分を再生できる機能。
    * シャドーイングやリピーティングの補助として利用可能。

### 2.4. 単語/イディオムの蓄積と管理

* **単語/イディオムのデータベース管理**:
    * シンプルにするため、Sentence Mining された単語やイディオムは、別テーブルを設けずに Sentence Mining カードだけで管理。
    * 単語やイディオムは、動詞や複数形などの変化は原形としてSentence Mining カードに格納。
    * シンプルにするため、同じ単語やイディオムかどうかは Sentence Mining カード内の該当情報が一致するかどうかだけで管理。
* **習得度合いの管理（指標の表示）**:
    * 習得度合い自体の直接的な管理や間隔反復のアルゴリズムは、このアプリでは行わない。

### 2.5. エピソードのグループ化と表示順序管理

* **エピソードグループ機能**:
    * ユーザーはエピソードを任意のグループに分類できる。
    * グループの作成、名称変更、削除が可能。
    * 各エピソードは1つのグループに所属する。
* **グループおよびエピソードの表示順序管理**:
    * ユーザーはグループの表示順序を自由に変更できる（ドラッグ＆ドロップ等）。
    * 各グループ内で、エピソードの表示順序もユーザーが変更できる。
    * 並び順は永続化され、次回以降も維持される。

---

## 3. 非機能要件

* **クロスプラットフォーム対応**: Tauri 2.x を利用し、Windows, macOS, Linux で動作すること。
* **パフォーマンス**: 大量の動画/音声ファイルやSentence Mining データを取り扱っても、動作が遅くならないこと。AI 文字起こしやLLM連携の処理速度も考慮する。
* **UI/UX**: 直感的で使いやすいインターフェース。学習者がスムーズに作業を進められるデザイン。
* **拡張性**: 将来的に機能追加やAIモデルの変更に対応しやすいアーキテクチャ。
* **データ管理**: ユーザーデータ（動画/音声パス、文字起こし結果、Sentence Mining データ、単語データベースなど）の永続化とバックアップ機能（手動）。
* **LLM連携**: OpenAI API など、LLMプロバイダーとの連携機能。APIキーの設定など、ユーザーが設定できること。（ver1 は Google Gemini に絞って良い）
* **プライバシー**: ユーザーの音声データや学習データが適切に管理され、外部に漏洩しない設計。

---

## 4. 将来的な拡張の可能性（現時点では対象外だが考慮に入れておく点）

* **スピーキング能力向上支援（MaskOutとの連携/統合）**:
    * 「英語穴埋め問題作成アプリ(MaskOut)」との連携強化、あるいは将来的な機能統合。
    * 音声認識による発音チェック（「正しくAIが音声認識できているか？」）。
* **シャドーイング/ディクテーション/リピーティングの補助機能**:
    * センテンス単位の再生機能に加え、ループ再生、速度調整など、より高度な音声再生オプション。
* **多言語対応の強化**:
    * ターゲット言語や母国語の選択肢を拡充。
    * LLM連携による多言語翻訳支援。
* **音声のないスクリプトのサポート**:
    * 音声再生はTTSで行う。
* **統計と進捗可視化**: 学習時間、Sentence Mining 数、新しい単語との出会いなどの統計情報を可視化するダッシュボード。
    * 各単語/イディオムについて、以下の指標を表示。
        * **Sentence Mining 回数**: その単語/イディオムが Sentence Mining の対象として選択された回数（分からなかった回数）。
* **単語/イディオムのデータベース管理の改善**:
    * 単語/イディオムを管理するテーブルを用意し、同じものは一つのエントリとして管理。
    * 同じ綴りでも意味が異なる場合は別エントリとして管理（例: `right` (右) と `right` (正しい)）。
    * 単語とそれが含まれるイディオムとの関連付け
    * 形容詞とそれが副詞になったものの関連付け
    * `un-` `in-` などが先頭について否定系になっている単語と、それらを外した単語との関連付け
    * `pick [-] up` と `pick up [-]` など目的語の位置が代わるものなどは、同じものとして管理。
