# Requirements Document

## Project Description (Input)

エピソード追加時に先にファイルによる追加かYouTube動画の追加かを選択させることで、両者の追加ダイアログを分離して互いに依存しないようにリファクタリングしたい

## Introduction

現在のエピソード追加機能では、ファイルとYouTube動画の追加が単一のダイアログ内で混在しており、相互依存による複雑性が発生している。このリファクタリングでは、事前選択UI によって両者を独立したダイアログに分離し、保守性とユーザビリティを向上させる。

## Requirements

### 要件1: エピソード追加方法選択UI

**目的:** ユーザーとして、エピソード追加時に事前に方法を選択したい。これにより、専用のダイアログで効率的に追加作業を行える。

#### 受入基準

1. When ユーザーがエピソード追加ボタンをクリックした場合、Kotonohaアプリは方法選択ダイアログを表示する
2. The 方法選択ダイアログは「ファイル追加」と「YouTube動画追加」の2つのオプションを提供する
3. When ユーザーが方法選択ダイアログでオプションを選択した場合、Kotonohaアプリは対応する専用ダイアログを開く
4. When ユーザーが方法選択ダイアログをキャンセルした場合、Kotonohaアプリはダイアログを閉じてメイン画面に戻る
5. The 方法選択ダイアログはシンプルで直感的なUI を提供する

### 要件2: ファイル追加専用ダイアログ

**目的:** ユーザーとして、ファイルベースのエピソード追加に特化したダイアログを使用したい。これにより、不要なYouTube関連の要素なしで効率的にファイルを設定できる。

#### 受入基準

1. When ユーザーが「ファイル追加」を選択した場合、Kotonohaアプリはファイル専用の追加ダイアログを表示する
2. The ファイル追加ダイアログは音声ファイルとスクリプトファイルの選択機能のみを含む
3. The ファイル追加ダイアログはTSV設定、TTS設定、スクリプト言語検出機能を含む
4. The ファイル追加ダイアログはYouTube関連の入力要素やロジックを一切含まない
5. When ユーザーがファイル追加を完了した場合、Kotonohaアプリはエピソードを作成しダイアログを閉じる
6. If ファイル追加処理でエラーが発生した場合、Kotonohaアプリは適切なエラーメッセージを表示する

### 要件3: YouTube動画追加専用ダイアログ

**目的:** ユーザーとして、YouTube動画追加に特化したダイアログを使用したい。これにより、不要なファイル関連の要素なしで効率的にYouTube動画を設定できる。

#### 受入基準

1. When ユーザーが「YouTube動画追加」を選択した場合、Kotonohaアプリは YouTube専用の追加ダイアログを表示する
2. The YouTube追加ダイアログはYouTube URL入力とメタデータ取得機能のみを含む
3. The YouTube追加ダイアログは自動字幕取得、言語設定、品質選択機能を含む
4. The YouTube追加ダイアログはローカルファイル関連の入力要素やロジックを一切含まない
5. When ユーザーがYouTube動画追加を完了した場合、Kotonohaアプリはエピソードを作成しダイアログを閉じる
6. If YouTube動画追加処理でエラーが発生した場合、Kotonohaアプリは適切なエラーメッセージを表示する

### 要件4: ダイアログ間の独立性確保

**目的:** 開発者として、ファイル追加とYouTube追加の機能が相互に依存しない実装にしたい。これにより、各機能の保守と拡張を独立して行える。

#### 受入基準

1. The ファイル追加ダイアログのストアとロジックはYouTube関連のストアやロジックに依存しない
2. The YouTube追加ダイアログのストアとロジックはファイル関連のストアやロジックに依存しない
3. The 各ダイアログは独立したSvelteコンポーネントとして実装される
4. The 各ダイアログは独立したストア（`fileEpisodeAddStore`、`youtubeEpisodeAddStore`）を使用する
5. When いずれかのダイアログでエラーが発生した場合、他方のダイアログの状態に影響を与えない

### 要件5: 統合コンポーネント・ストアの削除

**目的:** 開発者として、不要になった中間コンポーネントとストアを除去したい。これにより、アーキテクチャの簡素化とコードベースの保守性向上を実現できる。

#### 受入基準

1. The `EpisodeAddModal`コンポーネントは完全に削除される
2. The `episodeAddStore`（統合ストア）は完全に削除される
3. The `EpisodeAddModal`への参照は全てのコンポーネントから除去される
4. The `episodeAddStore`への参照は全てのコンポーネントから除去される
5. When リファクタリング完了後、削除されたコンポーネント・ストアに関連するコードはコードベースに残存しない
6. The ビルドプロセスは削除されたファイルに関する警告やエラーを出力しない

### 要件6: 既存機能との互換性

**目的:** ユーザーとして、リファクタリング後も従来と同等の機能を使用したい。これにより、機能の削減なしに改善されたUXを享受できる。

#### 受入基準

1. The 新しいダイアログ群は既存の`addNewEpisode`ユースケースと同じAPI契約を維持する
2. The ファイル追加ダイアログは既存のTSV設定、TTS設定機能を完全にサポートする
3. The YouTube追加ダイアログは既存の自動字幕取得、メタデータ処理機能を完全にサポートする
4. The 作成されるエピソードデータは既存の形式と完全に互換性を持つ
5. When リファクタリング完了後、既存のテストケースは引き続き合格する
